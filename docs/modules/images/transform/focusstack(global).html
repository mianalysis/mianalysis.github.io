<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>ModularImageAnalysis (MIA)</title>
  <link rel="shortcut icon" href="../../../img/logos/logo_square_partclip_192.png" type="image/x-icon" />

  <!-- CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-tomorrow.min.css"
    integrity="sha512-kSwGoyIkfz4+hMo5jkJngSByil9jxJPKbweYec/UgS+S1EgE45qm4Gea7Ks2oxQ7qiYyyZRn66A9df2lMtjIsw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="../../../css/style.css" rel="stylesheet">

  <!-- Javascript -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js"
    integrity="sha512-UOoJElONeUNzQbbKQbjldDf9MwOHqxNz49NNJJ1d90yp+X9edsHyJoAs6O4K19CZGaIdjI5ohK+O2y5lBTW6uQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-bash.min.js"
    integrity="sha512-35RBtvuCKWANuRid6RXP2gYm4D5RMieVL/xbp6KiMXlIqgNrI7XRUh9HurE8lKHW4aRpC0TZU3ZfqG8qmQ35zA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-powershell.min.js"
    integrity="sha512-dnJS1fxEUNZirzvtoG39P8JWa8DajX420LajzUbn+taV6hd9BfnHHgpPAWNADYjNRPT1Gt4v4/XGMULqi0uqVQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="../../../js/script.js"></script>
</head>

<body>
  <!-- Navigation bar -->
  <nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
    <div class="container-fluid">
      <div>
        <a class="navbar-brand" href="../../../index.html" style="padding-bottom: 0px;">
          <img height="36" src="../../../img/logos/logo_64.png" style="padding-bottom: 3px; padding-right:0px;">
        </a>
        <a class="navbar-brand mia-name mia-mobile" href="../../../index.html" style="float:right; padding-top: 6px;">
          MIA
        </a>
        <a class="navbar-brand mia-name mia-desktop" href="../../../index.html" style="float:right; padding-top: 6px;">
          ModularImageAnalysis (MIA)
        </a>
      </div>
      <buton class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
        style="border: none;">
        <span class="navbar-toggler-icon"></span>
      </buton>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item ">
            <a class="nav-link" href="../../../index.html">Home</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../../../guides/index.html">Guides</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="../../../modules/index.html">Modules</a>
          </li>
          <li class="nav-item ${ACTIVE_PUBLICATIONS}">
            <a class="nav-link" href="../../../publications.html">Publications</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../../../about.html">About</a>
          </li>
          <a class="btn btn-outline-primary ml-2 mia-nav-button" href="../../../guides/gettingstarted.html">Get
            started</a>
      </div>
      </ul>
    </div>
    </div>
  </nav>

  <div class="page-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
    <p class="mia-main-text"><a href="../../../modules/index.html">Modules</a> > <a href="../../../modules/images/index.html">Images</a> > <a href="../../../modules/images/transform/index.html">Transform</a></p>
    <p class="mia-title">Focus stack (global)</p>
    <p class="mia-main-text-large">Extract a Z-substack from an input stack based on either manually-selected slices, or an automatically-calculated best-focus slice.</p>
</div>

<div class="mia-text-block mx-auto mia-page">
    <p class="text-center mia-heading">Description</p>
    <p class="text-center mia-main-text">Extract a Z-substack from an input stack based on either manually-selected slices, or an automatically-calculated best-focus slice.  For automated methods, best focus is determined using intensity statistics (e.g. largest variance) of all pixels in each slice.  When in manual mode, only the best focus slice for the first and last timepoints need be specified (all others will be estimated using polynomial spline interpolation); however, more frames can be specified if preferred.<br><br>Irrespective of the calculation method (manual or automatic), it's possible to extract a fixed number of slices above and below the determined best-focus slice.</p>
</div>

<div class="mia-text-block mx-auto mia-page">
    <p class="text-center mia-heading">Parameters</p>
    <!-- <p class="text-center mia-main-text"><tr><td class="mia-table-text-bold">Input image</td><td>Image to extract substack from.</td></tr><tr><td class="mia-table-text-bold">Output mode</td><td>Controls whether the best focus positions are calculated and applied (creating a new image) or simply calculated.  In both cases, statistics for the best focus position (mean, median, minimum, maximum and standard deviation of slices) are stored as measurements associated with the input image.</td></tr><tr><td class="mia-table-text-bold">Output image</td><td>Substack image to be added to the current workspace.</td></tr><tr><td class="mia-table-text-bold">Best-focus calculation</td><td>Method for determining the best-focus slice.<br><ul><li>"Manual" Displays a control window, allowing the user to specify reference slices.  These slices should be at the same true z-plane.  Once complete, a substack will be extracted a specific number of slices above and below the reference plane (defined by "Relative start slice" and "Relative end slice".  If references aren't specific for all timepoints, the missing frames will be estimated using polynomial spline interpolation.</li><li>"Smallest mean intensity" The reference slice is taken as the slice with the minimum mean intensity.</li><li>"Largest mean intensity" The reference slice is taken as the slice with the maximum mean intensity.</li><li>"Smallest standard deviation" The reference slice is taken as the slice with the minimum intensity standard deviation.</li><li>"Largest standard deviation" The reference slice is taken as the slice with the maximum intensity standard deviation.</li></ul></td></tr><tr><td class="mia-table-text-bold">Relative start slice</td><td>Index of start slice relative to determined best-focus slice (i.e. -5 is 5 slices below the best-focus).</td></tr><tr><td class="mia-table-text-bold">Relative end slice</td><td>Index of end slice relative to determined best-focus slice (i.e. 5 is 5 slices above the best-focus).</td></tr><tr><td class="mia-table-text-bold">Reference image</td><td>If using manual selection of best focus slices, this is the image that will be shown to the user.  While it doesn't need to be the input image (the one the output substack will be generated from), it must have the same number of slices and timepoints as the input.</td></tr><tr><td class="mia-table-text-bold">Calculation source</td><td>When using automatic best focus slice determination this controls the image source:<br><ul><li>"External" The image for which intensity statistics are calculated is different to the image that the final substack will be created from.  For example, this could be an filtered version of the input image to enhance structures when in focus.</li><li>"Internal" The same image will be used for determination of the best slice and generation of the output substack.</li></ul></td></tr><tr><td class="mia-table-text-bold">External source</td><td>If using a separate image to determine the best focus slice ("Calculation source" set to "External"), this is the image that will be used for that calculation.</td></tr><tr><td class="mia-table-text-bold">Channel mode</td><td>How many channels to use when calculating the best-focus slice.  "Use all channels" will use all channels, whereas "Use single channel" will base the calculation on a single, user-defined channel.</td></tr><tr><td class="mia-table-text-bold">Channel</td><td>Channel to base the best-focus calculation on.</td></tr><tr><td class="mia-table-text-bold">Smooth timeseries</td><td>Apply median filter to best focus slice index over time.  This should smooth the transitions over time (prevent large jumps between frames).</td></tr><tr><td class="mia-table-text-bold">Smoothing range (odd numbers)</td><td>Number of frames over which to calculate the median.  If the specified number is even it will be increased by 1.</td></tr></p> -->
    <table class="table table-striped">
        <thead class="mia-main-text-small mia-bold">
            <tr>
                <td>Parameter</td>
                <td>Description</td>
            </tr>
        </thead>
        <tbody class="mia-main-text-small">
            <tr><td class="mia-table-text-bold">Input image</td><td>Image to extract substack from.</td></tr><tr><td class="mia-table-text-bold">Output mode</td><td>Controls whether the best focus positions are calculated and applied (creating a new image) or simply calculated.  In both cases, statistics for the best focus position (mean, median, minimum, maximum and standard deviation of slices) are stored as measurements associated with the input image.</td></tr><tr><td class="mia-table-text-bold">Output image</td><td>Substack image to be added to the current workspace.</td></tr><tr><td class="mia-table-text-bold">Best-focus calculation</td><td>Method for determining the best-focus slice.<br><ul><li>"Manual" Displays a control window, allowing the user to specify reference slices.  These slices should be at the same true z-plane.  Once complete, a substack will be extracted a specific number of slices above and below the reference plane (defined by "Relative start slice" and "Relative end slice".  If references aren't specific for all timepoints, the missing frames will be estimated using polynomial spline interpolation.</li><li>"Smallest mean intensity" The reference slice is taken as the slice with the minimum mean intensity.</li><li>"Largest mean intensity" The reference slice is taken as the slice with the maximum mean intensity.</li><li>"Smallest standard deviation" The reference slice is taken as the slice with the minimum intensity standard deviation.</li><li>"Largest standard deviation" The reference slice is taken as the slice with the maximum intensity standard deviation.</li></ul></td></tr><tr><td class="mia-table-text-bold">Relative start slice</td><td>Index of start slice relative to determined best-focus slice (i.e. -5 is 5 slices below the best-focus).</td></tr><tr><td class="mia-table-text-bold">Relative end slice</td><td>Index of end slice relative to determined best-focus slice (i.e. 5 is 5 slices above the best-focus).</td></tr><tr><td class="mia-table-text-bold">Reference image</td><td>If using manual selection of best focus slices, this is the image that will be shown to the user.  While it doesn't need to be the input image (the one the output substack will be generated from), it must have the same number of slices and timepoints as the input.</td></tr><tr><td class="mia-table-text-bold">Calculation source</td><td>When using automatic best focus slice determination this controls the image source:<br><ul><li>"External" The image for which intensity statistics are calculated is different to the image that the final substack will be created from.  For example, this could be an filtered version of the input image to enhance structures when in focus.</li><li>"Internal" The same image will be used for determination of the best slice and generation of the output substack.</li></ul></td></tr><tr><td class="mia-table-text-bold">External source</td><td>If using a separate image to determine the best focus slice ("Calculation source" set to "External"), this is the image that will be used for that calculation.</td></tr><tr><td class="mia-table-text-bold">Channel mode</td><td>How many channels to use when calculating the best-focus slice.  "Use all channels" will use all channels, whereas "Use single channel" will base the calculation on a single, user-defined channel.</td></tr><tr><td class="mia-table-text-bold">Channel</td><td>Channel to base the best-focus calculation on.</td></tr><tr><td class="mia-table-text-bold">Smooth timeseries</td><td>Apply median filter to best focus slice index over time.  This should smooth the transitions over time (prevent large jumps between frames).</td></tr><tr><td class="mia-table-text-bold">Smoothing range (odd numbers)</td><td>Number of frames over which to calculate the median.  If the specified number is even it will be increased by 1.</td></tr>
        </tbody>
    </table>
</div>

  <!-- Footer -->
  <footer>
    <div class="container-fluid padding mia-page">
      <div class="row text-light">
        <div class="col-3 mia-footer">
          <a href="https://www.bristol.ac.uk/wolfson-bioimaging/">
            <img class="mia-footer-logo" src="../../../img/logos/wbif.png">
          </a>
        </div>
        <div class="col-3 mia-footer text-center">
          <a href="https://twitter.com/_mianalysis/">
            <img class="mia-footer-logo" src="../../../img/logos/twitter_64.png">
        </div>
        <div class="col-3 mia-footer text-center">
          <a href="https://www.youtube.com/@mianalysis">
            <img class="mia-footer-logo" src="../../../img/logos/youtube_64.png">
        </div>
        <div class="col-3 mia-footer d-sm-none text-right">
          <a href="https://github.com/mianalysis/mia/">
            <img class="mia-footer-logo" src="../../../img/logos/GitHub-Mark-Light-64px.png">
          </a>
        </div>
        <div class="col-3 mia-footer d-none d-sm-block text-right">
          <a href="https://github.com/mianalysis/mia/">
            <img class="mia-footer-logo" src="../../../img/logos/GitHub-Mark-Light-64px.png"><img class="mia-footer-logo" src="../../../img/logos/GitHub_Logo_White.png">
          </a>
        </div>
      </div>
    </div>
  </footer>

  <script src="../../../js/script.js" type="text/javascript"></script>

</body>

</html>