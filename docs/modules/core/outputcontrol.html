<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>ModularImageAnalysis (MIA)</title>
  <link rel="shortcut icon" href="../../img/logos/logo_square_partclip_192.png" type="image/x-icon" />

  <!-- CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-tomorrow.min.css"
    integrity="sha512-kSwGoyIkfz4+hMo5jkJngSByil9jxJPKbweYec/UgS+S1EgE45qm4Gea7Ks2oxQ7qiYyyZRn66A9df2lMtjIsw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="../../css/style.css" rel="stylesheet">

  <!-- Javascript -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js"
    integrity="sha512-UOoJElONeUNzQbbKQbjldDf9MwOHqxNz49NNJJ1d90yp+X9edsHyJoAs6O4K19CZGaIdjI5ohK+O2y5lBTW6uQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-bash.min.js"
    integrity="sha512-35RBtvuCKWANuRid6RXP2gYm4D5RMieVL/xbp6KiMXlIqgNrI7XRUh9HurE8lKHW4aRpC0TZU3ZfqG8qmQ35zA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-powershell.min.js"
    integrity="sha512-dnJS1fxEUNZirzvtoG39P8JWa8DajX420LajzUbn+taV6hd9BfnHHgpPAWNADYjNRPT1Gt4v4/XGMULqi0uqVQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="../../js/script.js"></script>
</head>

<body>
  <!-- Navigation bar -->
  <nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
    <div class="container-fluid">
      <div>
        <a class="navbar-brand" href="../../index.html" style="padding-bottom: 0px;">
          <img height="36" src="../../img/logos/logo_64.png" style="padding-bottom: 3px; padding-right:0px;">
        </a>
        <a class="navbar-brand mia-name mia-mobile" href="../../index.html" style="float:right; padding-top: 6px;">
          MIA
        </a>
        <a class="navbar-brand mia-name mia-desktop" href="../../index.html" style="float:right; padding-top: 6px;">
          ModularImageAnalysis (MIA)
        </a>
      </div>
      <buton class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
        style="border: none;">
        <span class="navbar-toggler-icon"></span>
      </buton>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item ">
            <a class="nav-link" href="../../index.html">Home</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../../guides/index.html">Guides</a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="../../modules/index.html">Modules</a>
          </li>
          <li class="nav-item ${ACTIVE_PUBLICATIONS}">
            <a class="nav-link" href="../../publications.html">Publications</a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../../about.html">About</a>
          </li>
          <a class="btn btn-outline-primary ml-2 mia-nav-button" href="../../guides/gettingstarted.html">Get
            started</a>
      </div>
      </ul>
    </div>
    </div>
  </nav>

  <div class="page-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
    <p class="mia-main-text"><a href="../../modules/index.html">Modules</a> > <a href="../../modules/core/index.html">Core</a></p>
    <p class="mia-title">Output control</p>
    <p class="mia-main-text-large">Controls data export for each analysis run (job) as well as providing the option to run a final macro on all data.</p>
</div>

<div class="mia-text-block mx-auto mia-page">
    <p class="text-center mia-heading">Description</p>
    <p class="text-center mia-main-text">Controls data export for each analysis run (job) as well as providing the option to run a final macro on all data.  If running a single file analysis, by default, the spreadsheet will be saved with the same name as the input file and stored at the same location.  Whereas, in batch mode (running multiple files from a folder) the spreadsheet will be saved in that folder with the same name as the input folder.  Using the "Group save location" parameter it's possible to redirect the output spreadsheet(s) to a specific location.<br><br>Data can be collated into a single Excel spreadsheet, or exported as one spreadsheet per analysis run (job).  Exported spreadsheets are separated into multiple sheets:<br><ul><li>"Parameters" An overview of the analysis setup (path to workflow file, date run, computer operating system) along with a list of all modules and parameters, their values and states.  The information here should be sufficient to reconstruct the analysis workflow in the absence of the original workflow file.</li><li>"Log" A list of any error messages presented to the user while the analysis was running.</li><li>"Summary" Each analysis run is summarised by a single line (or one line per timepoint or metadata value, if selected) containing metadata values, image measurements, the number of objects detected as well as statistics for object collections (e.g. mean of a particular measurement).  The summary sheet is intended to facilitate quick analysis; all data contained in this sheet (with the exception of image measurements) can be manually compiled from the individual object sheets.  This sheet can be enabled/disabled using the "Export summary" parameter.</li><li>"[Object-specific sheets]" Each object collection can export to a separate sheet.  These sheets contain one row per object in that collection and include metadata values, along with all measurements and relationships for that object.  This sheet can be enabled/disabled using the "Export individual objects" parameter.</li></ul><br>It's also possible to select the data to be exported for each sheet, including the metadata values (filename, series number, etc.), individual measurements and object collection statistics.</p>
</div>

<div class="mia-text-block mx-auto mia-page">
    <p class="text-center mia-heading">Parameters</p>
    <!-- <p class="text-center mia-main-text"><tr><td class="mia-table-text-bold">Add variable</td><td>Pre-define variables, which will be immediately accessible within the macro.  These can be used to provide user-controllable values to file-based macros or to prevent the need for editing macro code via the "Output control" panel.</td></tr><tr><td class="mia-table-text-bold">Variable type</td><td>Controls the data type of the variable that will be assigned within the macro:<br><ul>"Boolean" Variable will be assigned a true/false value depending on whether the checkbox was selected/deselected (respectively).</li>."Number" Variable will be assigned a numeric value to which mathematical operations can be applied.</li>."Text" Variable will be assigned a text value.  Irrespective of whether the value contains only numeric characters this will be interpreted as text.</li></ul>.</td></tr><tr><td class="mia-table-text-bold">Variable name</td><td>The variable value can be accessed from within the macro by using this variable name.</td></tr><tr><td class="mia-table-text-bold">Variable checkbox</td><td>Boolean (true/false) value assigned to this variable if "Variable type" is set to "Boolean".</td></tr><tr><td class="mia-table-text-bold">Variable numeric value</td><td>Numeric value assigned to this variable if "Variable type" is set to "Number".</td></tr><tr><td class="mia-table-text-bold">Variable text value</td><td>Text value assigned to this variable if "Variable type" is set to "Text".</td></tr><tr><td class="mia-table-text-bold">Run macro</td><td>When selected, a final macro can be run once all the analysis runs (jobs) have been completed.  By using the workspace handling macros ("MIA_GetListOfWorkspaceIDs" and "MIA_SetActiveWorkspace") it's possible to switch between workspaces, thus facilitating dataset-wide analyses.  This macro will be executed only once as part of the final data exporting phase of the analysis.</td></tr><tr><td class="mia-table-text-bold">Macro mode</td><td>Select the source for the macro code:<br><ul><li>"Macro file" Load the macro from the file specified by the "Macro file" parameter.</li><li>"Macro text" Macro code is written directly into the "Macro text" box.</li></ul></td></tr><tr><td class="mia-table-text-bold">Macro text</td><td>Macro code to be executed.  MIA macro commands are enabled using the "run("Enable MIA Extensions");" command which is included by default.  This should always be the first line of a macro if these commands are needed.</td></tr><tr><td class="mia-table-text-bold">Macro file</td><td>Select a macro file (.ijm) to run once, after all analysis runs have completed.</td></tr><tr><td class="mia-table-text-bold">Export mode</td><td>Controls the number of results spreadsheets that are exported and what they contain:<br><ul><li>"All together" Results from all current analysis runs are grouped into a single spreadsheet.  The same sheets are used for all runs, so it's necessary to include a filename (and where necessary, a series name/number) metadata identifier.  Unless "Save name mode" is set to "Specific name", this file is named after the input file/folder.</li><li>"Group by metadata" Results are grouped and exported by a specific metadata item associated with each analysis run.  Unless "Save name mode" is set to "Specific name", the files are named in the format "[input file/folder name]_[metadata name]-[metadata value]".  The metadata item to group on is specified by the "Metadata item for grouping" parameter.</li><li>"Individual files" A separate results spreadsheet is saved for each analysis run.</li><li>"None" No results spreadsheets are exported.</li></ul></td></tr><tr><td class="mia-table-text-bold">Individual save location</td><td>If "Export mode" is set to "Individual files" this parameter controls where the individual results files are saved:<br><ul><li>"Mirrored directory" The files are saved in a mirrored directory structure.  This structure has the same folder layout as all subfolders of the specified input folder.  The root location of the mirrored structure is specified by the "Mirrored directory root" parameter.</li><li>"Save with input file" The files are saved in the same folder as the input file.  If a folder was selected as the input, the result files are saved directly inside that folder.</li><li>"Specific location" The files are all saved in a single folder specified by the "File path" parameter.</li></ul></td></tr><tr><td class="mia-table-text-bold">Group save location</td><td>If "Export mode" is set to "Group by metadata" this parameter controls where the grouped (by metadata) results files are saved:<br><ul><li>"Save with input file" The files are saved in the same folder as the input file.  If a folder was selected as the input, the result files are saved directly inside that folder.</li><li>"Specific location" The files are all saved in a single folder specified by the "File path" parameter.</li></ul></td></tr><tr><td class="mia-table-text-bold">File path</td><td>The path to the folder where results will be saved if using a specific folder path.</td></tr><tr><td class="mia-table-text-bold">Mirrored directory root</td><td>If using a mirrored directory structure for the results files, this parameter specifies the output structure root.  Subfolders will be created within this root folder that have identical structure to the subfolders of the input folder.</td></tr><tr><td class="mia-table-text-bold">Save name mode</td><td>Controls how the output results filename is generated:<br><ul><li>"Match input file/folder name" Results files are stored with the same name as the input file/folder (depending on the "Export mode" parameter).</li><li>"Specific name" Results files are stored with a specific name, specified by "File name".</li></ul></td></tr><tr><td class="mia-table-text-bold">File name</td><td>Name to save the results file with if saving results files with a specific name ("Save name mode" parameter).</td></tr><tr><td class="mia-table-text-bold">Metadata item for grouping</td><td>If "Export mode" is set to "Group by metadata", results will be grouped and saved by the value of this metadata item associated with each analysis run.  There will be one results spreadsheet for each unique value of this metadata item.</td></tr><tr><td class="mia-table-text-bold">Continuous data export</td><td>When selected, the results spreadsheet(s) can be exported at intervals during a multi-analysis run.  They will be exported every N runs, where N is controlled by the "Save every n files" parameter.  The spreadsheet(s) will still be stored when all analysis runs have completed.</td></tr><tr><td class="mia-table-text-bold">Save every n files</td><td>If "Continuous data export" is enabled, the current version of the spreadsheet will be exported after every N analysis runs.  This means if the analysis fails or the computer crashes, results collected so far are not lost.</td></tr><tr><td class="mia-table-text-bold">Append date/time mode</td><td>Controls under what conditions the time and date will be appended on to the end of the results file filename.  This can be used to prevent accidental over-writing of results files from previous runs:<br><ul><li>"Always" Always append the time and date on to the end of the filename.</li><li>"If file exists" Only append the time and date if the results file already exists.</li><li>"Never" Never append time and date (unless the file is open and unwritable).</li></ul></td></tr><tr><td class="mia-table-text-bold">Export summary</td><td>When selected, a summary sheet will be added to the results spreadsheet.  The summary sheet contains either (1) one row per input image file, (2) one row per timepoint per image file or (3) one row per metadata item.  The export mode is controlled by the "Summary mode" parameter.  This sheet is given the name "SUMMARY" and contains statistics for measurements (mean, min, max, standard deviation and sum), object counts and metadata items.</td></tr><tr><td class="mia-table-text-bold">Summary mode</td><td>Controls the form of the summary sheet (if "Export summary" is selected):<br><ul><li>"Per timepoint per input file" Each timepoint of each input image file is summarised in a separate row.</li><li>"Group by metadata" All files matching a specific metadata value are averaged and summarised in a separate row (i.e. one row per unique metadata item).</li><li>"Per input file" Each input image file is summarised in a separate row.</li></ul></td></tr><tr><td class="mia-table-text-bold">Metadata item for summary</td><td>The metadata item to group the rows of the summary sheet by if "Summary mode" is set to "Group by metadata".</td></tr><tr><td class="mia-table-text-bold">Show object counts</td><td>When selected, the "Summary" results sheet displays columns reporting the number of objects per object collection.</td></tr><tr><td class="mia-table-text-bold">Export individual objects</td><td>When selected, individual results sheets will be created for each object collection.  In these sheets, each object in that collection is summarised per row.  The individual object sheets have the same name as their corresponding object collection.</td></tr></p> -->
    <table class="table table-striped">
        <thead class="mia-main-text-small mia-bold">
            <tr>
                <td>Parameter</td>
                <td>Description</td>
            </tr>
        </thead>
        <tbody class="mia-main-text-small">
            <tr><td class="mia-table-text-bold">Add variable</td><td>Pre-define variables, which will be immediately accessible within the macro.  These can be used to provide user-controllable values to file-based macros or to prevent the need for editing macro code via the "Output control" panel.</td></tr><tr><td class="mia-table-text-bold">Variable type</td><td>Controls the data type of the variable that will be assigned within the macro:<br><ul>"Boolean" Variable will be assigned a true/false value depending on whether the checkbox was selected/deselected (respectively).</li>."Number" Variable will be assigned a numeric value to which mathematical operations can be applied.</li>."Text" Variable will be assigned a text value.  Irrespective of whether the value contains only numeric characters this will be interpreted as text.</li></ul>.</td></tr><tr><td class="mia-table-text-bold">Variable name</td><td>The variable value can be accessed from within the macro by using this variable name.</td></tr><tr><td class="mia-table-text-bold">Variable checkbox</td><td>Boolean (true/false) value assigned to this variable if "Variable type" is set to "Boolean".</td></tr><tr><td class="mia-table-text-bold">Variable numeric value</td><td>Numeric value assigned to this variable if "Variable type" is set to "Number".</td></tr><tr><td class="mia-table-text-bold">Variable text value</td><td>Text value assigned to this variable if "Variable type" is set to "Text".</td></tr><tr><td class="mia-table-text-bold">Run macro</td><td>When selected, a final macro can be run once all the analysis runs (jobs) have been completed.  By using the workspace handling macros ("MIA_GetListOfWorkspaceIDs" and "MIA_SetActiveWorkspace") it's possible to switch between workspaces, thus facilitating dataset-wide analyses.  This macro will be executed only once as part of the final data exporting phase of the analysis.</td></tr><tr><td class="mia-table-text-bold">Macro mode</td><td>Select the source for the macro code:<br><ul><li>"Macro file" Load the macro from the file specified by the "Macro file" parameter.</li><li>"Macro text" Macro code is written directly into the "Macro text" box.</li></ul></td></tr><tr><td class="mia-table-text-bold">Macro text</td><td>Macro code to be executed.  MIA macro commands are enabled using the "run("Enable MIA Extensions");" command which is included by default.  This should always be the first line of a macro if these commands are needed.</td></tr><tr><td class="mia-table-text-bold">Macro file</td><td>Select a macro file (.ijm) to run once, after all analysis runs have completed.</td></tr><tr><td class="mia-table-text-bold">Export mode</td><td>Controls the number of results spreadsheets that are exported and what they contain:<br><ul><li>"All together" Results from all current analysis runs are grouped into a single spreadsheet.  The same sheets are used for all runs, so it's necessary to include a filename (and where necessary, a series name/number) metadata identifier.  Unless "Save name mode" is set to "Specific name", this file is named after the input file/folder.</li><li>"Group by metadata" Results are grouped and exported by a specific metadata item associated with each analysis run.  Unless "Save name mode" is set to "Specific name", the files are named in the format "[input file/folder name]_[metadata name]-[metadata value]".  The metadata item to group on is specified by the "Metadata item for grouping" parameter.</li><li>"Individual files" A separate results spreadsheet is saved for each analysis run.</li><li>"None" No results spreadsheets are exported.</li></ul></td></tr><tr><td class="mia-table-text-bold">Individual save location</td><td>If "Export mode" is set to "Individual files" this parameter controls where the individual results files are saved:<br><ul><li>"Mirrored directory" The files are saved in a mirrored directory structure.  This structure has the same folder layout as all subfolders of the specified input folder.  The root location of the mirrored structure is specified by the "Mirrored directory root" parameter.</li><li>"Save with input file" The files are saved in the same folder as the input file.  If a folder was selected as the input, the result files are saved directly inside that folder.</li><li>"Specific location" The files are all saved in a single folder specified by the "File path" parameter.</li></ul></td></tr><tr><td class="mia-table-text-bold">Group save location</td><td>If "Export mode" is set to "Group by metadata" this parameter controls where the grouped (by metadata) results files are saved:<br><ul><li>"Save with input file" The files are saved in the same folder as the input file.  If a folder was selected as the input, the result files are saved directly inside that folder.</li><li>"Specific location" The files are all saved in a single folder specified by the "File path" parameter.</li></ul></td></tr><tr><td class="mia-table-text-bold">File path</td><td>The path to the folder where results will be saved if using a specific folder path.</td></tr><tr><td class="mia-table-text-bold">Mirrored directory root</td><td>If using a mirrored directory structure for the results files, this parameter specifies the output structure root.  Subfolders will be created within this root folder that have identical structure to the subfolders of the input folder.</td></tr><tr><td class="mia-table-text-bold">Save name mode</td><td>Controls how the output results filename is generated:<br><ul><li>"Match input file/folder name" Results files are stored with the same name as the input file/folder (depending on the "Export mode" parameter).</li><li>"Specific name" Results files are stored with a specific name, specified by "File name".</li></ul></td></tr><tr><td class="mia-table-text-bold">File name</td><td>Name to save the results file with if saving results files with a specific name ("Save name mode" parameter).</td></tr><tr><td class="mia-table-text-bold">Metadata item for grouping</td><td>If "Export mode" is set to "Group by metadata", results will be grouped and saved by the value of this metadata item associated with each analysis run.  There will be one results spreadsheet for each unique value of this metadata item.</td></tr><tr><td class="mia-table-text-bold">Continuous data export</td><td>When selected, the results spreadsheet(s) can be exported at intervals during a multi-analysis run.  They will be exported every N runs, where N is controlled by the "Save every n files" parameter.  The spreadsheet(s) will still be stored when all analysis runs have completed.</td></tr><tr><td class="mia-table-text-bold">Save every n files</td><td>If "Continuous data export" is enabled, the current version of the spreadsheet will be exported after every N analysis runs.  This means if the analysis fails or the computer crashes, results collected so far are not lost.</td></tr><tr><td class="mia-table-text-bold">Append date/time mode</td><td>Controls under what conditions the time and date will be appended on to the end of the results file filename.  This can be used to prevent accidental over-writing of results files from previous runs:<br><ul><li>"Always" Always append the time and date on to the end of the filename.</li><li>"If file exists" Only append the time and date if the results file already exists.</li><li>"Never" Never append time and date (unless the file is open and unwritable).</li></ul></td></tr><tr><td class="mia-table-text-bold">Export summary</td><td>When selected, a summary sheet will be added to the results spreadsheet.  The summary sheet contains either (1) one row per input image file, (2) one row per timepoint per image file or (3) one row per metadata item.  The export mode is controlled by the "Summary mode" parameter.  This sheet is given the name "SUMMARY" and contains statistics for measurements (mean, min, max, standard deviation and sum), object counts and metadata items.</td></tr><tr><td class="mia-table-text-bold">Summary mode</td><td>Controls the form of the summary sheet (if "Export summary" is selected):<br><ul><li>"Per timepoint per input file" Each timepoint of each input image file is summarised in a separate row.</li><li>"Group by metadata" All files matching a specific metadata value are averaged and summarised in a separate row (i.e. one row per unique metadata item).</li><li>"Per input file" Each input image file is summarised in a separate row.</li></ul></td></tr><tr><td class="mia-table-text-bold">Metadata item for summary</td><td>The metadata item to group the rows of the summary sheet by if "Summary mode" is set to "Group by metadata".</td></tr><tr><td class="mia-table-text-bold">Show object counts</td><td>When selected, the "Summary" results sheet displays columns reporting the number of objects per object collection.</td></tr><tr><td class="mia-table-text-bold">Export individual objects</td><td>When selected, individual results sheets will be created for each object collection.  In these sheets, each object in that collection is summarised per row.  The individual object sheets have the same name as their corresponding object collection.</td></tr>
        </tbody>
    </table>
</div>

  <!-- Footer -->
  <footer>
    <div class="container-fluid padding mia-page">
      <div class="row text-light">
        <div class="col-3 mia-footer">
          <a href="https://www.bristol.ac.uk/wolfson-bioimaging/">
            <img class="mia-footer-logo" src="../../img/logos/wbif.png">
          </a>
        </div>
        <div class="col-3 mia-footer text-center">
          <a href="https://twitter.com/_mianalysis/">
            <img class="mia-footer-logo" src="../../img/logos/twitter_64.png">
        </div>
        <div class="col-3 mia-footer text-center">
          <a href="https://www.youtube.com/@mianalysis">
            <img class="mia-footer-logo" src="../../img/logos/youtube_64.png">
        </div>
        <div class="col-3 mia-footer d-sm-none text-right">
          <a href="https://github.com/mianalysis/mia/">
            <img class="mia-footer-logo" src="../../img/logos/GitHub-Mark-Light-64px.png">
          </a>
        </div>
        <div class="col-3 mia-footer d-none d-sm-block text-right">
          <a href="https://github.com/mianalysis/mia/">
            <img class="mia-footer-logo" src="../../img/logos/GitHub-Mark-Light-64px.png"><img class="mia-footer-logo" src="../../img/logos/GitHub_Logo_White.png">
          </a>
        </div>
      </div>
    </div>
  </footer>

  <script src="../../js/script.js" type="text/javascript"></script>

</body>

</html>